%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#0A1628','primaryTextColor':'#fff','primaryBorderColor':'#D4AF37','lineColor':'#D4AF37','secondaryColor':'#F8F9FA','tertiaryColor':'#E8E9EA'}}}%%

graph TB
    subgraph "User Layer"
        U1[Web Frontend<br/>React + wagmi]
        U2[SDK Integration<br/>TypeScript]
        U3[Direct Contract<br/>Interaction]
    end

    subgraph "Application Layer"
        SDK[Gravitas SDK<br/>gravitas-sdk/]
        SDK --> |EIP-712 Signing| SIG[Signature Utils]
        SDK --> |Compliance Check| COMP[Compliance Module]
    end

    subgraph "Smart Contract Layer - Arbitrum"
        PR[GravitasPolicyRegistry<br/>0xbcaE...4679]
        T2[Teleport V2<br/>Uniswap V2 Migrations]
        T3[TeleportV3<br/>0x5D42...E993<br/>Uniswap V3 + EIP-712]
        
        T2 --> |Policy Check| PR
        T3 --> |Policy Check| PR
    end

    subgraph "DeFi Protocols"
        UV2F[Uniswap V2<br/>Factory]
        UV2R[Uniswap V2<br/>Router]
        UV3PM[Uniswap V3<br/>Position Manager]
        UV3SR[Uniswap V3<br/>Swap Router]
        
        T2 --> |Remove LP| UV2F
        T2 --> |Add LP| UV2R
        T3 --> |Manage NFT| UV3PM
        T3 --> |Execute Swap| UV3SR
    end

    subgraph "Governance & Security"
        OWNER[Protocol Owner<br/>Multi-sig]
        AUDIT[Security Audits<br/>Pending]
        SHARIAH[Shariah Advisory<br/>Board]
        
        OWNER --> |Update Policy| PR
        SHARIAH --> |Asset Review| PR
        AUDIT --> |Verification| T2
        AUDIT --> |Verification| T3
    end

    U1 --> SDK
    U2 --> SDK
    U3 --> T2
    U3 --> T3
    
    SDK --> T2
    SDK --> T3
    SDK --> PR

    style PR fill:#0A1628,stroke:#D4AF37,stroke-width:3px,color:#fff
    style T2 fill:#0A1628,stroke:#D4AF37,stroke-width:3px,color:#fff
    style T3 fill:#0A1628,stroke:#D4AF37,stroke-width:3px,color:#fff
    style SDK fill:#1A2638,stroke:#D4AF37,stroke-width:2px,color:#fff
    style U1 fill:#2A3648,stroke:#D4AF37,stroke-width:2px,color:#fff
    style OWNER fill:#D4AF37,stroke:#0A1628,stroke-width:2px,color:#0A1628
    style SHARIAH fill:#D4AF37,stroke:#0A1628,stroke-width:2px,color:#0A1628
